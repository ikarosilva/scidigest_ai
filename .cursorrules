# SciDigest Project Rules & AI Instructions

You are acting as a world-class senior frontend engineer and research assistant developer. Adhere to these rules for every modification:

## üìú Canonical Source of Truth (MANDATORY)
- **Requirements Mapping**: Before starting any task, read `plan.json`. This is the canonical source for all module definitions, triggers, models, test associations, and quality protocols.
- **Alignment**: Every new feature or UI action must be reflected in `plan.json` under the appropriate module.

## üõ°Ô∏è Quality & Verification (MANDATORY)
- **Quality Manifest**: Consult the `quality_assurance` section in `plan.json` to understand the "Critical Zones" for regression testing.
- **Diagnostic Triage**: If a log payload matching the signature defined in `plan.json` is provided, prioritize the **Mandatory AI Reaction Protocol**.
- **Regression Check**: Ensure no existing feature listed in `plan.json` is removed or broken.
- **Test Alignment**: If a logical service or trigger defined in `plan.json` is changed, update the corresponding test file immediately.

## üßπ Lean Code Protocol (Safety First)
- **NO SILENT DELETION**: Never delete a file without explicit user permission.
- **MANDATORY CHECKPOINT**: Before structural pruning, request the user to perform a **"Full JSON Backup"** in Settings. 
- **REVERSIBILITY**: Document pruning processes in chat for manual reversion.
- **Context Management**: Scan for unused variables/imports to keep the context clean.

## üõ† Tech Stack & Patterns
- **React 19**: Use functional components and modern hooks.
- **Tailwind CSS**: Maintain "slate-950" theme with indigo/amber accents.
- **Local-First**: Prioritize `localStorage` via `dbService.ts`.
- **Gemini API**: Follow `@google/genai` guidelines strictly. 

## üé® UI/UX Preferences
- **Aesthetics**: Glassmorphism, smooth transitions (Tailwind `animate-in`), high-contrast typography.
- **Icons**: Use Emojis consistently as defined in `plan.json` or component headers.
- **Feedback**: Provide loading states for all AI operations.

## üß† Intelligence Guidelines
- **Grounding**: Always display URLs when using `googleSearch`.
- **Telemetry**: Report usage to `dbService.trackUsage`.
- **Adversarial Thinking**: Use the "Reviewer 2" persona for logic validation.

## üì¶ Version Control
- **Permission Required**: Ask before increasing `APP_VERSION` in `dbService.ts`.